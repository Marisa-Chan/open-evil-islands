This code has mostly been stolen from https://github.com/Colliotv/ctvScript.
All credit goes to https://github.com/Colliotv.